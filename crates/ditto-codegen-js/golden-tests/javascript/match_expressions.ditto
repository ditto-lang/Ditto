module Test exports (..);

import Data.Stuff (Five(..));

type Maybe(a) = Just(a) | Nothing;

type ManyFields(a, b, c, d) = ManyFields(a, b, c, d);

with_default = (maybe: Maybe(a), default: a): a ->
    match maybe with
    | Just(a) -> a
    | Nothing -> default;

mk_five = (five) ->
    match five with
    | Five -> 5;

many_fields_to_array = (mf : ManyFields(a, a, a, a)): Array(a) -> 
    match mf with
    | ManyFields(a, b, c, d) -> [a, b, c, d];

is_just = (maybe): Bool ->
    match maybe with
    | Just(_) -> true
    | Nothing -> false;

function_arms = (maybe: Maybe(Int)) ->
    match maybe with
    | Just(a) -> (b, c) -> [a, b, c]
    | Nothing -> (b, c) -> [1, b, c];

very_function_arms = (maybe: Maybe(Int)) ->
    match maybe with
    | Just(a) -> (b) -> (c) -> (d) -> [a, b, c]
    | Nothing -> (b) -> (c) -> (d) -> [1, b, c];

effect_arms = (maybe) ->
    match maybe with
    | Just(a) -> do { return a }
    | Nothing -> do { return 5 };

type ABC =
    | A
    | B
    | C;

to_string = (abc) ->
    match abc with
    | A -> "A"
    | B -> "C"
    | C -> "C";
